@{
    ViewBag.Title = "Восстановление пароля";
}

<form method="POST" class="form_two_columns">
    <table>
        <tr>
            <td class="td_value_text">
                <b>Логин <span class="required_asterisk">*</span>:<b>
            </td>
            <td>
                <input type="text" name="login" maxlength="32" size="32" value="@Request.Form["login"]" />
            </td>
        </tr>
        @if (ViewBag.IsLoginCorrect == true)
        {
            <tr>
                <td colspan="2" class="td_text">
                    <b>Секретный вопрос:<b><br />
                    @ViewBag.SecretQuestion
                </td>
            </tr>
            <tr>
                <td class="td_value_text">
                    <b>Ответ на секретный вопрос <span class="required_asterisk">*</span>:<b>
                </td>
                <td>
                    <input type="text" name="secret_answer" maxlength="128" size="32" value="@Request.Form["secret_answer"]" />
                </td>
            </tr>
        }
        @if (ViewBag.IsSecretAnswerCorrect == true)
        {
            <tr>
                <td class="td_value_text">
                    <b>Новый пароль <span class="required_asterisk">*</span>:<b>
                </td>
                <td>
                    <input type="text" name="password" maxlength="128" size="32" value="@Request.Form["password"]" />
                </td>
            </tr>
            <tr>
                <td class="td_value_text">
                    <b>Подтверждение нового пароля <span class="required_asterisk">*</span>:<b>
                </td>
                <td>
                    <input type="text" name="password_2" maxlength="128" size="32" value="@Request.Form["password_2"]" />
                </td>
            </tr>
        }
        @if ((ViewBag.Errors != null) && (ViewBag.Errors.Count != 0))
        {
            <tr>
                <td colspan="2" class="td_errors">
                    @foreach (string error in ViewBag.Errors)
                    {
                        @error<br />
                    }
                </td>
            </tr>
        }
        <tr>
            <td colspan="2" class="td_buttons">
                @if ((ViewBag.IsLoginCorrect == null) || (ViewBag.IsLoginCorrect == false))
                {
                    <input type="submit" name="next" value="Далее" /><br />
                }
                else if ((ViewBag.IsLoginCorrect == true) && ((ViewBag.IsSecretAnswerCorrect == null) || (ViewBag.IsSecretAnswerCorrect == false)))
                {
                    <input type="submit" name="next_2" value="Далее" /><br />
                }
                else if (ViewBag.IsSecretAnswerCorrect == true)
                {
                    <input type="submit" name="ok" value="Восстановить пароль" /><br />
                }
                @Html.ActionLink("Авторизация", "Authorization", "Main")<br />
                @Html.ActionLink("Регистрация", "Registration", "Main")
            </td>
        </tr>
    </table>
</form>